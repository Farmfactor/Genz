<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Report: Generation Alpha & The Future of Education</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #FDFBF8;
            color: #4B4B4B;
        }
        .nav-link {
            transition: color 0.3s ease;
            position: relative;
            padding-bottom: 4px;
        }
        .nav-link::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            background-color: #D97706;
            transition: width 0.3s ease;
        }
        .nav-link:hover::after, .nav-link.active::after {
            width: 100%;
        }
        .slide {
            display: none;
            min-height: 80vh;
            animation: fadeIn 0.5s ease-in-out;
        }
        .slide.active {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .stat-card {
            background-color: #FFFFFF;
            border: 1px solid #F3EFEA;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .trait-card {
            background-color: #FFFFFF;
            border: 1px solid #F3EFEA;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .trait-card.active {
            border-color: #D97706;
            background-color: #FFFBEB;
            transform: scale(1.03);
        }
        .trait-card.inactive {
            opacity: 0.5;
            filter: grayscale(80%);
        }
        .implication-card {
            background-color: #F7F5F2;
            border: 1px solid #EAE6E1;
            transition: all 0.3s ease;
        }
        .implication-card.highlight {
            background-color: #FEF3C7;
            border-color: #FBBF24;
            box-shadow: 0 0 15px rgba(251, 191, 36, 0.3);
        }
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.5s ease-in-out;
        }
        .animate-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes pulse {
            0%, 100% {
                opacity: 1;
            }
            50% {
                opacity: .5;
            }
        }
    </style>
</head>
<body class="antialiased">

    <header class="bg-white/80 backdrop-blur-md sticky top-0 z-50 shadow-sm border-b border-gray-200/50">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <h1 class="text-xl font-bold text-amber-700">Gen Alpha Insights</h1>
            <div class="hidden md:flex space-x-8">
                <a href="#" class="nav-link slide-nav-link active" data-slide-index="0">Introduction</a>
                <a href="#" class="nav-link slide-nav-link" data-slide-index="1">Core Traits</a>
                <a href="#" class="nav-link slide-nav-link" data-slide-index="2">Educational Impact</a>
                <a href="#" class="nav-link slide-nav-link" data-slide-index="3">Recommendations</a>
            </div>
            <button id="mobile-menu-button" class="md:hidden text-gray-700 focus:outline-none">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-4 6h4"></path></svg>
            </button>
        </nav>
        <div id="mobile-menu" class="hidden md:hidden px-6 pb-4">
            <a href="#" class="block py-2 text-center nav-link slide-nav-link" data-slide-index="0">Introduction</a>
            <a href="#" class="block py-2 text-center nav-link slide-nav-link" data-slide-index="1">Core Traits</a>
            <a href="#" class="block py-2 text-center nav-link slide-nav-link" data-slide-index="2">Educational Impact</a>
            <a href="#" class="block py-2 text-center nav-link slide-nav-link" data-slide-index="3">Recommendations</a>
        </div>
    </header>

    <main class="container mx-auto px-6 py-12">
        <!-- Slide 1: Introduction -->
        <section class="slide active" id="slide-0">
            <div class="text-center py-16">
                <h2 class="text-4xl md:text-6xl font-bold tracking-tight text-gray-800">The Alpha Generation</h2>
                <p class="mt-4 text-lg md:text-xl text-gray-600 max-w-3xl mx-auto">Born into a world of AI, ubiquitous screens, and unprecedented connectivity, Generation Alpha is redefining childhood and demanding a fundamental transformation of education. This interactive report explores their unique traits and the challenges and opportunities they present.</p>
                <div class="mt-12 grid grid-cols-1 md:grid-cols-3 gap-8 max-w-4xl mx-auto">
                    <div class="stat-card p-6 rounded-xl shadow-md">
                        <div class="text-4xl font-bold text-amber-600" data-target="2">0</div>
                        <p class="mt-2 text-gray-600 font-medium">Billion+ Globally by 2025</p>
                        <p class="text-sm text-gray-500 mt-1">The largest generation in history.</p>
                    </div>
                    <div class="stat-card p-6 rounded-xl shadow-md">
                        <div class="text-4xl font-bold text-amber-600" data-target="48">0</div>
                        <p class="mt-2 text-gray-600 font-medium">% White in the U.S.</p>
                        <p class="text-sm text-gray-500 mt-1">The most diverse generation yet.</p>
                    </div>
                    <div class="stat-card p-6 rounded-xl shadow-md">
                        <div class="text-4xl font-bold text-amber-600" data-target="76">0</div>
                        <p class="mt-2 text-gray-600 font-medium">% Can Code or Want to Learn</p>
                        <p class="text-sm text-gray-500 mt-1">Innate technological fluency.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Slide 2: Core Characteristics -->
        <section class="slide" id="slide-1">
            <div class="text-center mb-12">
                <h3 class="text-3xl md:text-4xl font-bold text-gray-800">Core Characteristics</h3>
                <p class="mt-3 text-lg text-gray-600 max-w-3xl mx-auto">Generation Alpha's worldview is shaped by a unique blend of digital immersion, global consciousness, and pandemic-era experiences. Explore their defining traits below, which form the basis for the educational challenges ahead.</p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <div class="p-6 stat-card rounded-lg">
                    <h4 class="font-bold text-lg text-amber-700">üì± AI-Native & Digital First</h4>
                    <p class="mt-2 text-gray-600">Technology isn't a tool; it's an extension of self. They've never known a world without smartphones, voice assistants, and on-demand content.</p>
                    <button class="mt-4 bg-amber-600 text-white px-4 py-2 rounded-full text-sm hover:bg-amber-700 transition-colors generate-elaboration" data-trait="AI-Native & Digital First">‚ú® Elaborate</button>
                </div>
                <div class="p-6 stat-card rounded-lg">
                    <h4 class="font-bold text-lg text-amber-700">‚ö° Shorter Attention Spans</h4>
                    <p class="mt-2 text-gray-600">Accustomed to short-form content (TikTok, Reels), they thrive on microlearning and struggle with sustained, passive focus.</p>
                    <button class="mt-4 bg-amber-600 text-white px-4 py-2 rounded-full text-sm hover:bg-amber-700 transition-colors generate-elaboration" data-trait="Shorter Attention Spans">‚ú® Elaborate</button>
                </div>
                <div class="p-6 stat-card rounded-lg">
                    <h4 class="font-bold text-lg text-amber-700">üéÆ Visual & Interactive Learners</h4>
                    <p class="mt-2 text-gray-600">They prefer gamified, multimedia, and hands-on learning over traditional textbooks and lectures. Learning must be an experience.</p>
                    <button class="mt-4 bg-amber-600 text-white px-4 py-2 rounded-full text-sm hover:bg-amber-700 transition-colors generate-elaboration" data-trait="Visual & Interactive Learners">‚ú® Elaborate</button>
                </div>
                <div class="p-6 stat-card rounded-lg">
                    <h4 class="font-bold text-lg text-amber-700">üåç Globally Conscious</h4>
                    <p class="mt-2 text-gray-600">Hyper-connectedness exposes them to global issues like climate change and social justice from a young age, fostering empathy.</p>
                    <button class="mt-4 bg-amber-600 text-white px-4 py-2 rounded-full text-sm hover:bg-amber-700 transition-colors generate-elaboration" data-trait="Globally Conscious">‚ú® Elaborate</button>
                </div>
                <div class="p-6 stat-card rounded-lg">
                    <h4 class="font-bold text-lg text-amber-700">üèÜ Desire for Instant Gratification</h4>
                    <p class="mt-2 text-gray-600">They expect immediate feedback and results, challenging traditional academic structures that rely on delayed rewards.</p>
                    <button class="mt-4 bg-amber-600 text-white px-4 py-2 rounded-full text-sm hover:bg-amber-700 transition-colors generate-elaboration" data-trait="Desire for Instant Gratification">‚ú® Elaborate</button>
                </div>
                <div class="p-6 stat-card rounded-lg">
                    <h4 class="font-bold text-lg text-amber-700">ü§ù Individualistic & Socially Different</h4>
                    <p class="mt-2 text-gray-600">Preferring digital interaction (e.g., gaming platforms) can lead to gaps in face-to-face communication skills, a trend amplified by the pandemic.</p>
                    <button class="mt-4 bg-amber-600 text-white px-4 py-2 rounded-full text-sm hover:bg-amber-700 transition-colors generate-elaboration" data-trait="Individualistic & Socially Different">‚ú® Elaborate</button>
                </div>
                <div class="p-6 stat-card rounded-lg">
                    <h4 class="font-bold text-lg text-amber-700">‚úçÔ∏è Underdeveloped Fine Motor Skills</h4>
                    <p class="mt-2 text-gray-600">Increased screen time and less hands-on play can lead to challenges with tasks requiring fine motor coordination, like handwriting.</p>
                    <button class="mt-4 bg-amber-600 text-white px-4 py-2 rounded-full text-sm hover:bg-amber-700 transition-colors generate-elaboration" data-trait="Underdeveloped Fine Motor Skills">‚ú® Elaborate</button>
                </div>
            </div>
            <div id="trait-elaboration-section" class="py-12 bg-gray-50 mt-12 rounded-lg hidden">
                <div class="container mx-auto px-6">
                    <h3 class="text-2xl font-bold text-gray-800 mb-6">Elaboration on: <span id="elaboration-trait-title" class="text-amber-700"></span></h3>
                    <div id="elaboration-content" class="bg-white p-6 rounded-lg shadow-md text-gray-700 leading-relaxed">
                        <p id="elaboration-loading" class="text-center text-gray-500 hidden">Generating insights... Please wait.</p>
                        <div id="elaboration-text"></div>
                        <p id="elaboration-error" class="text-center text-red-500 hidden">Error generating elaboration. Please try again.</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Slide 3: Educational Impact -->
        <section class="slide" id="slide-2">
            <div class="text-center mb-12">
                <h3 class="text-3xl md:text-4xl font-bold text-gray-800">The Impact on Education</h3>
                <p class="mt-3 text-lg text-gray-600 max-w-4xl mx-auto">The traits of Generation Alpha directly translate into new challenges and opportunities for educators. Click on a trait below to see its corresponding educational implication and the recommended strategic response. This interaction reveals the direct line from student behavior to necessary pedagogical evolution.</p>
            </div>
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6" id="education-grid">
            </div>
            <div class="text-center mt-8">
                <button id="reset-button" class="bg-amber-600 text-white font-bold py-2 px-6 rounded-full hover:bg-amber-700 transition-colors duration-300">Reset View</button>
            </div>
        </section>
        
        <!-- Slide 4: Strategic Recommendations -->
        <section class="slide" id="slide-3">
            <div class="text-center mb-12">
                <h3 class="text-3xl md:text-4xl font-bold text-gray-800">Strategic Recommendations</h3>
                <p class="mt-3 text-lg text-gray-600 max-w-3xl mx-auto">To effectively prepare Generation Alpha, stakeholders must adopt a forward-thinking and adaptive approach. Here are five key strategic pillars for transforming education.</p>
            </div>
            <div class="max-w-3xl mx-auto space-y-4" id="accordion-container">
            </div>
        </section>
    </main>

    <footer class="bg-white/80 backdrop-blur-md sticky bottom-0 z-50 border-t border-gray-200/50">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <button id="prev-button" class="text-gray-700 font-bold py-2 px-4 rounded-full flex items-center transition-colors hover:text-amber-600 disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg>
                Previous
            </button>
            <div class="text-gray-500 text-sm">Slide <span id="current-slide-num">1</span> of <span id="total-slides">4</span></div>
            <button id="next-button" class="text-gray-700 font-bold py-2 px-4 rounded-full flex items-center transition-colors hover:text-amber-600">
                Next
                <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
            </button>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // General setup and mobile menu
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');
            mobileMenuButton.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });

            // Slideshow navigation logic
            let currentSlideIndex = 0;
            const slides = document.querySelectorAll('.slide');
            const navLinks = document.querySelectorAll('.slide-nav-link');
            const prevButton = document.getElementById('prev-button');
            const nextButton = document.getElementById('next-button');
            const currentSlideNum = document.getElementById('current-slide-num');
            const totalSlides = document.getElementById('total-slides');

            totalSlides.textContent = slides.length;

            function showSlide(index) {
                slides.forEach((slide, i) => {
                    slide.classList.remove('active');
                    if (i === index) {
                        slide.classList.add('active');
                    }
                });
                navLinks.forEach((link, i) => {
                    link.classList.remove('active');
                    if (i === index) {
                        link.classList.add('active');
                    }
                });
                prevButton.disabled = index === 0;
                nextButton.disabled = index === slides.length - 1;
                currentSlideNum.textContent = index + 1;
            }

            function nextSlide() {
                if (currentSlideIndex < slides.length - 1) {
                    currentSlideIndex++;
                    showSlide(currentSlideIndex);
                }
            }

            function prevSlide() {
                if (currentSlideIndex > 0) {
                    currentSlideIndex--;
                    showSlide(currentSlideIndex);
                }
            }

            prevButton.addEventListener('click', prevSlide);
            nextButton.addEventListener('click', nextSlide);
            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    currentSlideIndex = parseInt(e.target.dataset.slideIndex, 10);
                    showSlide(currentSlideIndex);
                    if (mobileMenu.classList.contains('hidden') === false) {
                        mobileMenu.classList.add('hidden');
                    }
                });
            });

            // Statistic counter animation
            function animateValue(obj, start, end, duration) {
                let startTimestamp = null;
                const step = (timestamp) => {
                    if (!startTimestamp) startTimestamp = timestamp;
                    const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                    obj.innerHTML = Math.floor(progress * (end - start) + start);
                    if (progress < 1) {
                        window.requestAnimationFrame(step);
                    } else {
                        obj.innerHTML = end;
                    }
                };
                window.requestAnimationFrame(step);
            }
            const counters = document.querySelectorAll('#slide-0 [data-target]');
            counters.forEach(counter => {
                const target = +counter.getAttribute('data-target');
                animateValue(counter, 0, target, 1500);
            });

            // Education Grid interaction logic
            const educationData = [
                {
                    trait: 'Digital Native/AI Immersion',
                    challenge: 'Digital dependency & rapid obsolescence of traditional methods.',
                    strategy: 'Integrate AI/AR/VR tools; emphasize digital literacy & responsible screen time.'
                },
                {
                    trait: 'Shorter Attention Spans',
                    challenge: 'Difficulty with sustained focus on traditional lectures or long tasks.',
                    strategy: 'Implement microlearning, gamification, and frequent hands-on activities.'
                },
                {
                    trait: 'Desire for Instant Gratification',
                    challenge: 'Low motivation for delayed rewards; demand for immediate feedback.',
                    strategy: 'Design gamified feedback loops and project-based learning with quick wins.'
                },
                {
                    trait: 'Visual/Interactive Preference',
                    challenge: 'Ineffectiveness of text-heavy, non-interactive teaching methods.',
                    strategy: 'Utilize multimedia, interactive platforms, and personalized learning experiences.'
                },
                {
                    trait: 'Individualistic/Social Gaps',
                    challenge: 'Deficits in face-to-face communication and group dynamics.',
                    strategy: 'Explicitly teach social skills; incorporate collaborative group activities.'
                },
                {
                    trait: 'Underdeveloped Fine Motor Skills',
                    challenge: 'Challenges with manual tasks like writing due to excessive screen time.',
                    strategy: 'Incorporate hands-on activities, traditional writing, and physical play.'
                }
            ];

            const educationGrid = document.getElementById('education-grid');
            const resetButton = document.getElementById('reset-button');

            function renderGrid(activeTrait = null) {
                educationGrid.innerHTML = '';
                
                const headerTitles = ['Core Trait', 'Educational Challenge', 'Strategic Response'];
                headerTitles.forEach(title => {
                    const headerDiv = document.createElement('div');
                    headerDiv.className = 'text-xl font-bold text-center text-gray-700 mb-4';
                    headerDiv.textContent = title;
                    educationGrid.appendChild(headerDiv);
                });

                educationData.forEach((item, index) => {
                    const traitCard = document.createElement('div');
                    traitCard.className = 'trait-card p-4 rounded-lg h-full flex items-center justify-center text-center';
                    traitCard.textContent = item.trait;
                    traitCard.dataset.index = index;

                    const challengeCard = document.createElement('div');
                    challengeCard.className = 'implication-card p-4 rounded-lg h-full flex items-center';
                    challengeCard.textContent = item.challenge;
                    challengeCard.dataset.index = index;

                    const strategyCard = document.createElement('div');
                    strategyCard.className = 'implication-card p-4 rounded-lg h-full flex items-center';
                    strategyCard.textContent = item.strategy;
                    strategyCard.dataset.index = index;

                    if (activeTrait !== null) {
                        if (item.trait === activeTrait) {
                            traitCard.classList.add('active');
                            challengeCard.classList.add('highlight');
                            strategyCard.classList.add('highlight');
                        } else {
                            traitCard.classList.add('inactive');
                        }
                    }

                    traitCard.addEventListener('click', () => renderGrid(item.trait));

                    educationGrid.appendChild(traitCard);
                    educationGrid.appendChild(challengeCard);
                    educationGrid.appendChild(strategyCard);
                });
            }
            
            if (educationGrid) {
                renderGrid();
            }
            
            if(resetButton) {
                resetButton.addEventListener('click', () => renderGrid());
            }

            // Accordion for recommendations logic
            const accordionData = [
                {
                    title: 'Proactive Technology Integration',
                    content: 'Invest in robust digital infrastructure (high-speed Wi-Fi, charging stations) and ensure equitable access to devices. Continuously integrate cutting-edge tech like AR, VR, and AI into learning platforms.'
                },
                {
                    title: 'Curriculum Modernization',
                    content: 'Shift focus from rote memorization to future-proof skills: critical thinking, creativity, and problem-solving. Prioritize STEM, coding, and AI literacy from an early age, alongside digital citizenship and media literacy.'
                },
                {
                    title: 'Comprehensive Teacher Training',
                    content: 'Provide extensive professional development for educators on integrating digital tools and innovative pedagogies like gamification and personalized learning. Support them in addressing challenges like diminished attention spans.'
                },
                {
                    title: 'Holistic Student Development',
                    content: 'Implement a framework that equally values academic, social-emotional, and physical well-being. Use Social-Emotional Learning (SEL) programs and integrate hands-on activities to balance screen time and develop fine motor skills.'
                },
                {
                    title: 'Fostering Collaborative Ecosystems',
                    content: 'Strengthen partnerships between schools, parents, and technology providers. Design flexible learning environments that promote both online and in-person collaboration, preparing students for an interconnected world.'
                }
            ];

            const accordionContainer = document.getElementById('accordion-container');
            if (accordionContainer) {
                accordionData.forEach((item, index) => {
                    const itemDiv = document.createElement('div');
                    itemDiv.className = 'border border-gray-200 rounded-lg bg-white';
                    
                    const button = document.createElement('button');
                    button.className = 'w-full flex justify-between items-center p-5 text-left font-semibold text-gray-700 hover:bg-gray-50';
                    button.innerHTML = `
                        <span>${item.title}</span>
                        <svg class="w-5 h-5 transform transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    `;

                    const contentDiv = document.createElement('div');
                    contentDiv.className = 'accordion-content';
                    contentDiv.innerHTML = `<p class="p-5 pt-0 text-gray-600">${item.content}</p>`;

                    itemDiv.appendChild(button);
                    itemDiv.appendChild(contentDiv);
                    accordionContainer.appendChild(itemDiv);

                    button.addEventListener('click', () => {
                        const isExpanded = contentDiv.style.maxHeight && contentDiv.style.maxHeight !== '0px';
                        
                        document.querySelectorAll('.accordion-content').forEach(el => el.style.maxHeight = '0px');
                        document.querySelectorAll('.accordion-container button svg').forEach(svg => svg.style.transform = 'rotate(0deg)');

                        if (!isExpanded) {
                            contentDiv.style.maxHeight = contentDiv.scrollHeight + 'px';
                            button.querySelector('svg').style.transform = 'rotate(180deg)';
                        }
                    });
                });
            }

            // Gemini API Integration for Trait Elaboration
            const elaborationSection = document.getElementById('trait-elaboration-section');
            const elaborationTraitTitle = document.getElementById('elaboration-trait-title');
            const elaborationContent = document.getElementById('elaboration-content');
            const elaborationLoading = document.getElementById('elaboration-loading');
            const elaborationText = document.getElementById('elaboration-text');
            const elaborationError = document.getElementById('elaboration-error');

            const generateElaborationButtons = document.querySelectorAll('.generate-elaboration');

            generateElaborationButtons.forEach(button => {
                button.addEventListener('click', async (event) => {
                    const trait = event.target.dataset.trait;
                    
                    elaborationSection.classList.remove('hidden');
                    elaborationTraitTitle.textContent = trait;
                    elaborationText.innerHTML = '';
                    elaborationError.classList.add('hidden');
                    elaborationLoading.classList.remove('hidden');
                    elaborationContent.classList.add('animate-pulse');

                    // Scroll to the new section
                    elaborationSection.scrollIntoView({ behavior: 'smooth', block: 'start' });

                    const prompt = `Elaborate on the characteristic of Generation Alpha: '${trait}'. Provide a detailed explanation, including why it's a defining trait and its general implications, in about 3-4 paragraphs. Focus on key aspects and real-world impact.`;

                    try {
                        const generatedText = await callGeminiAPI(prompt);
                        elaborationText.innerHTML = generatedText.replace(/\n/g, '<br>');
                        elaborationError.classList.add('hidden');
                    } catch (error) {
                        console.error('Gemini API call failed:', error);
                        elaborationText.innerHTML = '';
                        elaborationError.classList.remove('hidden');
                        elaborationError.textContent = 'Failed to generate insights. Please try again later.';
                    } finally {
                        elaborationLoading.classList.add('hidden');
                        elaborationContent.classList.remove('animate-pulse');
                    }
                });
            });

            async function callGeminiAPI(prompt, retries = 3, delay = 1000) {
                let chatHistory = [];
                chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                const payload = { contents: chatHistory };
                const apiKey = "";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

                for (let i = 0; i < retries; i++) {
                    try {
                        const response = await fetch(apiUrl, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });

                        if (!response.ok) {
                            if (response.status === 429 && i < retries - 1) {
                                await new Promise(res => setTimeout(res, delay));
                                delay *= 2;
                                continue;
                            }
                            throw new Error(`HTTP error! status: ${response.status}`);
                        }

                        const result = await response.json();
                        if (result.candidates && result.candidates.length > 0 &&
                            result.candidates[0].content && result.candidates[0].content.parts &&
                            result.candidates[0].content.parts.length > 0) {
                            return result.candidates[0].content.parts[0].text;
                        } else {
                            throw new Error('Unexpected API response structure or no content.');
                        }
                    } catch (error) {
                        if (i === retries - 1) throw error;
                        await new Promise(res => setTimeout(res, delay));
                        delay *= 2;
                    }
                }
                throw new Error('Failed to fetch from Gemini API after multiple retries.');
            }

            // Initial setup
            showSlide(currentSlideIndex);
        });
    </script>
</body>
</html>
